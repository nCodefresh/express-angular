version: '1.0'

steps:

#  generate-tag:
#    image: node:latest
#    working-directory: ${{initial-clone}}
#    commands:
#        - echo short ${{CF_SHORT_REVISION}}
#        - echo long ${{CF_REVISION}}

  build-project:
    type: build
    working-directory: ${{initial-clone}}
    description: codefresh example
    image-name: ncodefresh/express-angular-test
    dockerfile: Dockerfile
    tag: ${{CF_SHORT_REVISION}}

  launch-environment:
    image: codefreshio/cf-cli:latest
    commands:
        - node index.js login --token ${{TOKEN}} -u ${{USER}}
        - node index.js compositions run --id ${{ID_COMPOSITION}}

#  push-to-dockerhub:
#    type: push
#    candidate: ${{build-project}}
#    tag: ${{CF_BRANCH}}
